<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/stream.coffee</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/rtc.DataChannel.html">rtc.DataChannel</a></li>
                                <li><a href="../classes/rtc.internal.ChannelCollection.html">rtc.internal.ChannelCollection</a></li>
                                <li><a href="../classes/rtc.internal.Deferred.html">rtc.internal.Deferred</a></li>
                                <li><a href="../classes/rtc.internal.Promise.html">rtc.internal.Promise</a></li>
                                <li><a href="../classes/rtc.internal.StreamCollection.html">rtc.internal.StreamCollection</a></li>
                                <li><a href="../classes/rtc.LocalPeer.html">rtc.LocalPeer</a></li>
                                <li><a href="../classes/rtc.MediaDomElement.html">rtc.MediaDomElement</a></li>
                                <li><a href="../classes/rtc.Peer.html">rtc.Peer</a></li>
                                <li><a href="../classes/rtc.PeerConnection.html">rtc.PeerConnection</a></li>
                                <li><a href="../classes/rtc.RemotePeer.html">rtc.RemotePeer</a></li>
                                <li><a href="../classes/rtc.Room.html">rtc.Room</a></li>
                                <li><a href="../classes/rtc.signaling.Channel.html">rtc.signaling.Channel</a></li>
                                <li><a href="../classes/rtc.signaling.MucSignaling.html">rtc.signaling.MucSignaling</a></li>
                                <li><a href="../classes/rtc.signaling.MucSignalingPeer.html">rtc.signaling.MucSignalingPeer</a></li>
                                <li><a href="../classes/rtc.signaling.PalavaSignaling.html">rtc.signaling.PalavaSignaling</a></li>
                                <li><a href="../classes/rtc.signaling.PalavaSignalingPeer.html">rtc.signaling.PalavaSignalingPeer</a></li>
                                <li><a href="../classes/rtc.signaling.Signaling.html">rtc.signaling.Signaling</a></li>
                                <li><a href="../classes/rtc.signaling.SignalingPeer.html">rtc.signaling.SignalingPeer</a></li>
                                <li><a href="../classes/rtc.signaling.WebSocketChannel.html">rtc.signaling.WebSocketChannel</a></li>
                                <li><a href="../classes/rtc.Stream.html">rtc.Stream</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/rtc.html">rtc</a></li>
                                <li><a href="../modules/rtc.internal.html">rtc.internal</a></li>
                                <li><a href="../modules/rtc.signaling.html">rtc.signaling</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/stream.coffee</h1>

<div class="file">
    <pre class="code prettyprint linenums">
{compat} = require(&#x27;./compat&#x27;)


###*
# @module rtc
###
###*
# A wrapper around an HTML5 MediaStream
# @class rtc.Stream
#
# @constructor
# @param {RTCDataStream} stream The native stream
###
class exports.Stream

  constructor: (@stream) -&gt;


  ###*
  # Get the id of the stream. This is neither user defined nor human readable.
  # @method id
  # @return {String} The id of the underlying stream
  ###
  id: () -&gt;
    return @stream.id


  ###*
  # Checks whether the stream has any tracks of the given type
  # @method hasTracks
  # @param {&#x27;audio&#x27; | &#x27;video&#x27; | &#x27;both&#x27;} [type=&#x27;both&#x27;] The type of track to check for
  # @return {Number} The amount of tracks of the given type
  ###
  hasTracks: (type) -&gt;
    return @getTracks(type).length


  ###*
  # Gets the tracks of the given type
  # @method getTracks
  # @param {&#x27;audio&#x27; | &#x27;video&#x27; | &#x27;both&#x27;} [type=&#x27;both&#x27;] The type of tracks to get
  # @return {Array} An Array of the tracks
  ###
  getTracks: (type) -&gt;
    type = type.toLowerCase()

    if type == &#x27;audio&#x27;
      return @stream_p.then (stream) -&gt;
        return stream.getAudioTracks()
    else if type == &#x27;video&#x27;
      return @stream_p.then (stream) -&gt;
        return stream.getVideoTracks()
    else if type == &#x27;both&#x27;
      return @stream_p.then (stream) -&gt;
        video = stream.getVideoTracks()
        vaudio = stream.getAudioTracks()
        return video.concat(audio)
    else
      throw new Error(&quot;Invalid stream part &#x27;&quot; + type + &quot;&#x27;&quot;)


  ###*
  # Mutes or unmutes tracks of the stream
  # @method mute
  # @param {Boolean} [muted=true] Mute on &#x60;true&#x60; and unmute on &#x60;false&#x60;
  # @param {&#x27;audio&#x27; | &#x27;video&#x27; | &#x27;both&#x27;} [type=&#x27;audio&#x27;] The type of tracks to mute or unmute
  # @return {Boolean} Whether the tracks were muted or unmuted
  ###
  mute: (muted=true, type=&#x27;audio&#x27;) -&gt;
    for track in getTracks(type)
      track.enabled = not muted

    return muted


  ###*
  # Toggles the mute state of tracks of the stream
  # @method toggleMute
  # @param {&#x27;audio&#x27; | &#x27;video&#x27; | &#x27;both&#x27;} [type=&#x27;audio&#x27;] The type of tracks to mute or unmute
  # @return {Boolean} Whether the tracks were muted or unmuted
  ###
  toggleMute: (type=&#x27;audio&#x27;) -&gt;
    tracks = getTracks(type)

    muted = not tracks[0]?.enabled

    for track in tracks
      track.enabled = not muted

    return muted


  ###*
  # Stops the stream
  # @method stop
  ###
  stop: () -&gt;
    if @stream.getTracks?
      for track in @stream.getTracks()
        track.stop()
    else
      @stream.stop()


  ###*
  # Creates a stream using &#x60;getUserMedia()&#x60;
  # @method createStream
  # @static
  # @param {Object} [config={audio: true, video: true}] The configuration to pass to &#x60;getUserMedia()&#x60;
  # @return {Promise -&gt; rtc.Stream} Promise to the stream
  #
  # @example
  #     var stream = rtc.Stream.createStream({audio: true, video: false});
  #     rtc.MediaDomElement($(&#x27;video&#x27;), stream);
  ###
  @createStream: (config={audio: true, video: true}) -&gt;
    return new Promise (resolve, reject) -&gt;
      # description to pass to getUserMedia()
      success = (native_stream) -&gt;
        resolve(new Stream(native_stream))

      compat.getUserMedia(config, success, reject)

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
